{
    "collab_server" : "",
    "contents" : "#!/usr/bin/env R\n\n#Code to plot number of CNVs reported per sample\nWRKDIR <- \"/Users/collins/Desktop/RCollins/HMS/Courses/HST508/HST508_FinalProject/HST508_FinalProject_Figures/\"\n\n#Load library\nrequire(plotrix)\n\n#Read data\nall <- read.table(paste(WRKDIR,\"../plot_data/CNV_size_bySize.all.txt\",sep=\"\"),header=F)[,3:23]\nnc <- read.table(paste(WRKDIR,\"../plot_data/CNV_size_bySize.noncoding.txt\",sep=\"\"),header=F)[,3:23]\n\n#Set sizes vector\nsizes <- log10(c(2:9,seq(10,90,10),seq(100,400,100))*10000)\n\n#Prep plot\npdf(paste(WRKDIR,\"CNVs_by_size.pdf\",sep=\"\"),height=6,width=7)\npar(mfrow=c(2,2))\n\n#All deletions\npar(mar=c(3.1,3.1,1.1,1.1),bty=\"o\")\nplot(x=log10(c(20000,4000000)),y=c(0,-4),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     xaxt=\"n\",yaxt=\"n\",xlab=\"\",ylab=\"\")\n#Lines & axes\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),col=\"gray85\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1,5)*10^i))\n}))),col=\"gray75\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(10^i))\n}))),col=\"gray65\")\naxis(1,log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),labels=NA,col=\"gray65\")\naxis(1,log10(unlist(sapply(2:7,function(i){\n  return(c(10^i))\n}))),labels=NA)\naxis(1,log10(c(20000,50000,100000,500000,1000000,4000000)),tick=F,\n     line=-0.3,labels=c(\"20kb\",\"50kb\",\"100kb\",\"500kb\",\"1Mb\",\"4Mb\"),cex.axis=0.75)\nmtext(1,line=1.75,text=\"Minimum CNV Size\",cex=0.75)\nabline(h=0:-4,lty=2,col=\"gray80\")\naxis(2,0:-4,labels=c(\"100%\",\"10%\",\"1%\",\"0.1%\",\"0.01%\"),line=-0.8,las=2,tick=F,cex.axis=0.75)\nmtext(2,line=1.75,text=\"Pct. of CNVs > Min. Size\",cex=0.75)\nmtext(3,line=0,text=\"Deletions (All)\",font=2)\npoints(sizes,as.numeric(log10(all[1,])),type=\"l\",lwd=2)\npoints(sizes,as.numeric(log10(all[1,])),cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[3,])),type=\"l\",col=\"#55db74\",lwd=2)\npoints(sizes,as.numeric(log10(all[3,])),col=\"#55db74\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[5,])),type=\"l\",col=\"#5ebded\",lwd=2)\npoints(sizes,as.numeric(log10(all[5,])),col=\"#5ebded\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[7,])),type=\"l\",col=\"#c470f4\",lwd=2)\npoints(sizes,as.numeric(log10(all[7,])),col=\"#c470f4\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[9,])),type=\"l\",col=\"#fc3737\",lwd=2)\npoints(sizes,as.numeric(log10(all[9,])),col=\"#fc3737\",cex=0.5,pch=21,bg=\"white\")\n#Legend\nlegend(\"bottomleft\",legend=c(\"CTRL\",\"DD\",\"SCZ\",\"DD+SCZ\",\"CNCR\"),cex=0.75,bg=\"white\",\n       lwd=2,col=c(\"black\",\"#55db74\",\"#5ebded\",\"#c470f4\",\"#fc3737\"))\n\n#All duplications\npar(mar=c(3.1,3.1,1.1,1.1),bty=\"o\")\nplot(x=log10(c(20000,4000000)),y=c(0,-4),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     xaxt=\"n\",yaxt=\"n\",xlab=\"\",ylab=\"\")\n#Lines & axes\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),col=\"gray85\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1,5)*10^i))\n}))),col=\"gray75\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(10^i))\n}))),col=\"gray65\")\naxis(1,log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),labels=NA,col=\"gray65\")\naxis(1,log10(unlist(sapply(2:7,function(i){\n  return(c(10^i))\n}))),labels=NA)\naxis(1,log10(c(20000,50000,100000,500000,1000000,4000000)),tick=F,\n     line=-0.3,labels=c(\"20kb\",\"50kb\",\"100kb\",\"500kb\",\"1Mb\",\"4Mb\"),cex.axis=0.75)\nmtext(1,line=1.75,text=\"Minimum CNV Size\",cex=0.75)\nabline(h=0:-4,lty=2,col=\"gray80\")\naxis(2,0:-4,labels=c(\"100%\",\"10%\",\"1%\",\"0.1%\",\"0.01%\"),line=-0.8,las=2,tick=F,cex.axis=0.75)\nmtext(2,line=1.75,text=\"Pct. of CNVs > Min. Size\",cex=0.75)\nmtext(3,line=0,text=\"Duplications (All)\",font=2)\npoints(sizes,as.numeric(log10(all[2,])),type=\"l\",lwd=2)\npoints(sizes,as.numeric(log10(all[2,])),cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[4,])),type=\"l\",col=\"#55db74\",lwd=2)\npoints(sizes,as.numeric(log10(all[4,])),col=\"#55db74\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[6,])),type=\"l\",col=\"#5ebded\",lwd=2)\npoints(sizes,as.numeric(log10(all[6,])),col=\"#5ebded\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[8,])),type=\"l\",col=\"#c470f4\",lwd=2)\npoints(sizes,as.numeric(log10(all[8,])),col=\"#c470f4\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(all[10,])),type=\"l\",col=\"#fc3737\",lwd=2)\npoints(sizes,as.numeric(log10(all[10,])),col=\"#fc3737\",cex=0.5,pch=21,bg=\"white\")\n#Legend\nlegend(\"bottomleft\",legend=c(\"CTRL\",\"DD\",\"SCZ\",\"DD+SCZ\",\"CNCR\"),cex=0.75,bg=\"white\",\n       lwd=2,col=c(\"black\",\"#55db74\",\"#5ebded\",\"#c470f4\",\"#fc3737\"))\n\n#NC deletions\npar(mar=c(3.1,3.1,1.1,1.1),bty=\"o\")\nplot(x=log10(c(20000,4000000)),y=c(0,-4),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     xaxt=\"n\",yaxt=\"n\",xlab=\"\",ylab=\"\")\n#Lines & axes\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),col=\"gray85\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1,5)*10^i))\n}))),col=\"gray75\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(10^i))\n}))),col=\"gray65\")\naxis(1,log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),labels=NA,col=\"gray65\")\naxis(1,log10(unlist(sapply(2:7,function(i){\n  return(c(10^i))\n}))),labels=NA)\naxis(1,log10(c(20000,50000,100000,500000,1000000,4000000)),tick=F,\n     line=-0.3,labels=c(\"20kb\",\"50kb\",\"100kb\",\"500kb\",\"1Mb\",\"4Mb\"),cex.axis=0.75)\nmtext(1,line=1.75,text=\"Minimum CNV Size\",cex=0.75)\nabline(h=0:-4,lty=2,col=\"gray80\")\naxis(2,0:-4,labels=c(\"100%\",\"10%\",\"1%\",\"0.1%\",\"0.01%\"),line=-0.8,las=2,tick=F,cex.axis=0.75)\nmtext(2,line=1.75,text=\"Pct. of CNVs > Min. Size\",cex=0.75)\nmtext(3,line=0,text=\"Deletions (Noncoding)\",font=2)\npoints(sizes,as.numeric(log10(nc[1,])),type=\"l\",lwd=2)\npoints(sizes,as.numeric(log10(nc[1,])),cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[3,])),type=\"l\",col=\"#55db74\",lwd=2)\npoints(sizes,as.numeric(log10(nc[3,])),col=\"#55db74\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[5,])),type=\"l\",col=\"#5ebded\",lwd=2)\npoints(sizes,as.numeric(log10(nc[5,])),col=\"#5ebded\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[7,])),type=\"l\",col=\"#c470f4\",lwd=2)\npoints(sizes,as.numeric(log10(nc[7,])),col=\"#c470f4\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[9,])),type=\"l\",col=\"#fc3737\",lwd=2)\npoints(sizes,as.numeric(log10(nc[9,])),col=\"#fc3737\",cex=0.5,pch=21,bg=\"white\")\n#Legend\nlegend(\"bottomleft\",legend=c(\"CTRL\",\"DD\",\"SCZ\",\"DD+SCZ\",\"CNCR\"),cex=0.75,bg=\"white\",\n       lwd=2,col=c(\"black\",\"#55db74\",\"#5ebded\",\"#c470f4\",\"#fc3737\"))\n\n#NC duplications\npar(mar=c(3.1,3.1,1.1,1.1),bty=\"o\")\nplot(x=log10(c(20000,4000000)),y=c(0,-4),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     xaxt=\"n\",yaxt=\"n\",xlab=\"\",ylab=\"\")\n#Lines & axes\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),col=\"gray85\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(c(1,5)*10^i))\n}))),col=\"gray75\")\nabline(v=log10(unlist(sapply(1:10,function(i){\n  return(c(10^i))\n}))),col=\"gray65\")\naxis(1,log10(unlist(sapply(1:10,function(i){\n  return(c(c(1:9)*10^i))\n}))),labels=NA,col=\"gray65\")\naxis(1,log10(unlist(sapply(2:7,function(i){\n  return(c(10^i))\n}))),labels=NA)\naxis(1,log10(c(20000,50000,100000,500000,1000000,4000000)),tick=F,\n     line=-0.3,labels=c(\"20kb\",\"50kb\",\"100kb\",\"500kb\",\"1Mb\",\"4Mb\"),cex.axis=0.75)\nmtext(1,line=1.75,text=\"Minimum CNV Size\",cex=0.75)\nabline(h=0:-4,lty=2,col=\"gray80\")\naxis(2,0:-4,labels=c(\"100%\",\"10%\",\"1%\",\"0.1%\",\"0.01%\"),line=-0.8,las=2,tick=F,cex.axis=0.75)\nmtext(2,line=1.75,text=\"Pct. of CNVs > Min. Size\",cex=0.75)\nmtext(3,line=0,text=\"Duplications (Noncoding)\",font=2)\npoints(sizes,as.numeric(log10(nc[2,])),type=\"l\",lwd=2)\npoints(sizes,as.numeric(log10(nc[2,])),cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[4,])),type=\"l\",col=\"#55db74\",lwd=2)\npoints(sizes,as.numeric(log10(nc[4,])),col=\"#55db74\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[6,])),type=\"l\",col=\"#5ebded\",lwd=2)\npoints(sizes,as.numeric(log10(nc[6,])),col=\"#5ebded\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[8,])),type=\"l\",col=\"#c470f4\",lwd=2)\npoints(sizes,as.numeric(log10(nc[8,])),col=\"#c470f4\",cex=0.5,pch=21,bg=\"white\")\npoints(sizes,as.numeric(log10(nc[10,])),type=\"l\",col=\"#fc3737\",lwd=2)\npoints(sizes,as.numeric(log10(nc[10,])),col=\"#fc3737\",cex=0.5,pch=21,bg=\"white\")\n#Legend\nlegend(\"bottomleft\",legend=c(\"CTRL\",\"DD\",\"SCZ\",\"DD+SCZ\",\"CNCR\"),cex=0.75,bg=\"white\",\n       lwd=2,col=c(\"black\",\"#55db74\",\"#5ebded\",\"#c470f4\",\"#fc3737\"))\n\ndev.off()\n",
    "created" : 1481903469026.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2384991846",
    "id" : "E8EDA683",
    "lastKnownWriteTime" : 1481916799,
    "last_content_update" : 1481916800541,
    "path" : "~/Desktop/RCollins/HMS/Courses/HST508/HST508_FinalProject/HST508_FinalProject_Figures/CNV_size_by_group.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}